<!doctype s-function-doc system "s-function-doc.dtd" [
<!entity % S-OLD "INCLUDE">
]
>
<s-function-doc>
<s-topics>
<s-topic> summary.aareg </s-topic>
</s-topics>
<s-title>
<!--function to do???-->
</s-title>
<s-description>
<!--brief description-->
</s-description>
<s-usage>
<s-old-style-usage>
summary.aareg(x, maxtime, weight=c("var", "nrisk"))
</s-old-style-usage>
</s-usage>
<s-args-required>
</s-args-required>
<s-args-optional>
<!--move the above two lines to just above the first optional argument-->
<s-arg name=" x ">
<!--Describe x here-->
</s-arg>
<s-arg name=" maxtime ">
<!--Describe maxtime here-->
</s-arg>
<s-arg name=" weight ">
<!--Describe weight here-->
</s-arg>
</s-args-optional>
<s-value>
<!--Describe the value returned-->
</s-value>
<s-side-effects>
<!--describe any side effects if they exist-->
</s-side-effects>
<s-details>
<!--explain details here-->
</s-details>
<s-section name = "REFERENCES">
<!--put references here, make other sections like NOTE and WARNING with s-section-->
</s-section>
<s-see>
<!--put functions to SEE ALSO here-->
</s-see>
<s-examples>
<s-example>
<!--Put 1 or more s-example tags here-->
# The function is currently defined as
function(x, maxtime, weight = c("var", "nrisk"))
{
	if(!inherits(x, "aareg"))
		stop("Must be an aareg object")
	weight <- match.arg(weight)
	if(!missing(maxtime))
		ntime <- sum(x$time < maxtime)
	else ntime <- x$ntime[1]
	# Compute the test statistic
	if(weight == "var") twt <- (as.matrix(x$tweight))[1:ntime,  ] else twt <-
			1/x$nrisk[1:ntime]
	tx <- as.matrix(twt * x$increment[1:ntime,  ])
	test <- c(rep(1, ntime) %*% tx)
	#sum of weighted increments
	var <- t(tx) %*% tx
	#std Poisson, ind increments variance
	# Compute a fit (to get a "slope") 
	#  Since this is a single variable model, no intercept, I
	#  don't need to call lm.wfit!
	time <- x$time[1:ntime]
	nvar <- ncol(tx)
	ctx <- apply(tx, 2, cumsum)
	if(is.matrix(twt) && ncol(twt) > 1)
		tempwt <- apply(twt * time^2, 2, sum)
	else tempwt <- sum(twt * time^2)
	if(ncol(ctx) > 1)
		slope <- apply(ctx * time, 2, sum)/tempwt
	else slope <- sum(ctx * time)/temp2
	se <- sqrt(diag(var))
	mat <- cbind(slope, test, se, test/se, 2 * pnorm( - abs(test/se)))
	dimnames(mat) <- list((dimnames(x$inc)[[2]]), c("slope", "test", 
		"se(test)", "z", "p"))
	chi <- test %*% solve(var, test)
	temp <- list(table = mat, test = test, var = var, chisq = chi, ntime = 
		c(ntime, x$ntime[2]))
	oldClass(temp) <- "summary.aareg"
	temp
}
</s-example>
</s-examples>
<s-keywords>
<s-keyword>
<!--Put one or more s-keyword tags here-->
</s-keyword>
</s-keywords>
<s-docclass>
function
</s-docclass>
</s-function-doc>
