<!doctype s-function-doc system "s-function-doc.dtd" [
<!entity % S-OLD "INCLUDE">
]
>
<s-function-doc>
<s-topics>
<s-topic> aareg </s-topic>
</s-topics>
<s-title>
Aalen's additive regression model for censored data
</s-title>
<s-description>
Returns an object of class <s-expression>"aareg"</s-expression> that
represents an Aalen model.
</s-description>
<s-usage>
<s-old-style-usage>
aareg(formula, data=&lt;&lt;see below&gt;&gt;,
weights=&lt;&lt;see below&gt;&gt;,  
    subset=&lt;&lt;see below&gt;&gt;, na.action, 
   qrtol=1e-07, nmin)
</s-old-style-usage>
</s-usage>
<s-args-required>

<s-arg name=" formula ">
a formula object, with the response on the left of a `~' operator and 
the terms,
 separated by <s-expression>+</s-expression> operators, on the right. 
The response must be a <s-expression>Surv/s-expression> object.
</s-arg>
</s-args-required>
<s-args-optional>

<s-arg name=" data ">
data frame in which to interpret the variables named in the
<s-expression>formul a</s-expression>,
<s-expression>subset</s-expression>, and <s-expression>weights
</s-expression> arguments. This may also be a single number to handle
some speci al cases -- see below for details. If
<s-expression>data</s-expression> is missi ng, the variables in the
model formula should be in the search path.
</s-arg>

<s-arg name="weights">
vector of observation weights. If supplied, the fitting algorithm
minimizes the sum of the weights multiplied by the squared residuals
(see below for additional technical details). The length of
<s-expression>weights</s-expression> must be the same as the number of
observations. The weights must be nonnegative and it i s recommended
that they be strictly positive, since zero weights are ambiguous.  To
exclude particular observations from the model, use the
<s-expression>subset< /s-expression> argument instead of zero weights.
</s-arg>

<s-arg name="subset">
expression specifying which subset of observations should be used in
the fit. Th is can be a logical vector (which is replicated to have
length equal to the numb er of observations), a numeric vector
indicating the observation numbers to be i ncluded, or a character
vector of the observation names that should be included.  All
observations are included by default.
</s-arg>

<s-arg name="na.action">
a function to filter missing data. This is applied to the
<s-expression>model.fr ame</s-expression> after any
<s-expression>subset</s-expression> argument has be en applied. The
default is <s-expression>na.fail</s-expression>, which returns a n
error if any missing values are found. An alternative is
<s-expression>na.excl ude</s-expression>, which deletes observations
that contain one or more missing values.
</s-arg>

<s-arg name=" qrtol ">
tolerance for detection of singularity in the QR decomposition
</s-arg>

<s-arg name=" nmin ">
minimum number of observations for an estimate; defaults to 3 times the
number of covariates.
</s-arg>
</s-args-optional>

<s-value>
an object of class <s-expression>"aareg"</s-expression> 
representing the fit.
</s-value>

<s-details>
The Aalen model assumes that the cumulative hazard H(t) for a subject
can be expressed as a(t) + X B(t), where a(t) is a time-dependent intercept
term, X is the vector of covariates for the subject (possibly time-dependent),
and B(t) is a time-dependent matrix of coefficients.
The estimates are inheritly non-parametric; a fit of the model will normally
be followed by one or more plots of the estimates.

The estimates may become unstable near the tail of a data set, since the
increment to B at time t is based on the subjects still at risk at time
t.  The tolerance and/or nmin parameters may act to truncate the estimate
before the last death.
</s-details>
<s-section name = "REFERENCES">
Aalen, O.O. (1989). A linear regression model for the analysis of life times.
Statistics in Medicine, 8:907-925.

Aalen, O.O (1993). Further results on the non-parametric linear model in
survival analysis.  Statistics in Medicine. 12:1569-1588.
</s-section>
<s-see>
print.aareg, summary.aareg, plot.aareg
</s-see>
<s-examples>
<s-example>
# Fit a model to the lung cancer data set
> lfit <- aareg(Surv(time, status) ~ age + sex + ph.ecog, data=lung)

> lfit
Call:
aareg(formula = Surv(time, status) ~ age + sex + ph.ecog, data = lung)

135 out of 138 unique death times used

              slope    test se(test)       z      p 
Intercept  1.80e-03  0.0535    1.910  0.0281 0.9780
      age  2.44e-05  2.4900    2.220  1.1200 0.2610
      sex -1.16e-03 -0.0638    0.141 -0.4520 0.6510
  ph.ecog  1.00e-03  0.3730    0.163  2.3000 0.0217

Chisq= 36.32 on 4 df, p= 2.5e-07 

> plot(lfit[4])  # Draw a plot of the function for ph.ecog
</s-example>
</s-examples>
<s-keywords>
<s-keyword>
<!--Put one or more s-keyword tags here-->
</s-keyword>
</s-keywords>
<s-docclass>
function
</s-docclass>
</s-function-doc>
